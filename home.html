<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events Calendar</title>
    <!-- Link to Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">

    <style>
        /* Background image for body */
        body {
            background-image: url('your-background-image.jpg');
            background-size: cover;
        }

        /* Navbar styles */
        .navbar {
            background-color: rgb(147, 124, 224);
            overflow: hidden;
            height: 80px; /* Increase navbar height */
        }

        .navbar a {
            float: left;
            font-size: 20px;
            color: white;
            text-align: center;
            padding: 14px 16px;
            font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
           
        }

        .navbar a:hover {
            background-color: rgb(1, 1, 1);
        }

        /* Container styles */
        .calendar-container {
            width: 80%;
            margin: 0 auto;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        /* Add your existing styles for h2, form, input, and button here */
        h2 {
            text-align: center;
        }

        form {
            margin-top: 20px;
        }

        input[type="text"],
        input[type="password"],
        input[type="datetime-local"] {
            width: 100%;
            max-width: 250px; /* Set a maximum width for the input fields */
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        button[type="submit"] {
            width: 100%;
            padding: 10px;
            background-color: rgb(131, 131, 233);
            border: none;
            color: #fff;
            border-radius: 3px;
            cursor: pointer;
        }
        /* CSS for the animated heading */
.animated-heading {
    opacity: 0;
    animation: fadeIn 1s ease-in-out forwards;
    color: rgb(202, 43, 226);
}

@keyframes fadeIn {
    0% {
        opacity: 0;
        transform: translateY(-10px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}
#update{
    background-color: blue;
}
#delete{
    background-color: red;
}

    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <a class="navbar-brand" href="#">Home</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="true" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="login.html">Login</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="signup.html">Sign Up</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="aboutus.html">About Us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="contactus.html">Contact Us</a>
                </li>
            </ul>
        </div>
    </nav>


    <!-- Content Container -->
    <div class="calendar-container">
        <h2 class="animated-heading">Create Event</h2>
        <form id="event-form">
            <div class="form-group"> <!-- Wrap the input fields in a div -->
                <input type="text" id="eventName" name="eventName" class="form-control" placeholder="Event Name" required>
                <input type="datetime-local" id="eventDateTime" name="eventDateTime" class="form-control" required>
                <input type="text" id="eventLocation" name="eventLocation" class="form-control" placeholder="Event Location" required>
            </div>
            <div class="form-group"> <!-- Separate div for the textarea -->
                <textarea id="eventDescription" name="eventDescription" class="form-control" placeholder="Event Description"></textarea>
            </div>
            <img id="captcha-image" src="" alt="CAPTCHA Image">
t" class="btn btn-primary">ADD Event</button>
        </form>
    </div>
    

    <h2 style="font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif; text-align: center; color: mediumorchid;">Upcoming Events</h2><br>
    <div class="row justify-content-around" id="event-list">
    </div>

    <!-- Firebase modules script tags here -->
    <!-- Firebase modules script tags here -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-app.js";
    import { getDatabase, ref, push, onValue, update, remove, get } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-database.js";

    // Firebase configuration (replace with your Firebase project configuration)
    const firebaseConfig = {
            apiKey: "AIzaSyDWwZyIHKxVoSxNm7onExUI9ux04q4coDM",
            authDomain: "authentication-abf91.firebaseapp.com",
            projectId: "authentication-abf91",
            storageBucket: "authentication-abf91.appspot.com",
            messagingSenderId: "972135858201",
            appId: "1:972135858201:web:8f6666889ecb503f1faa88"
        };
    
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // Event creation form
    const eventForm = document.getElementById('event-form');
    const eventNameInput = document.getElementById('eventName');
    const eventDateTimeInput = document.getElementById('eventDateTime');
    const eventLocationInput = document.getElementById('eventLocation');
    const eventDescriptionInput = document.getElementById('eventDescription');

    // Event list container
    const eventList = document.getElementById('event-list');

    // Add button
    const addButton = document.getElementById('addButton');

    // Handle event creation form submission
          description: eventDescription
      
    // Handle event creation form submission
eventForm.addEventListener('submit', (e) => {
    e.preventDefault();

    // Get form values
    const eventName = eventNameInput.value;
    const eventDateTime = eventDateTimeInput.value;
    const eventLocation = eventLocationInput.value;
    const eventDescription = eventDescriptionInput.value;

    // Push event data to Firebase Realtime Database
    const eventsRef = ref(database, 'events');
    push(eventsRef, {
        name: eventName,
        dateTime: eventDateTime,
        location: eventLocation,
        description: eventDescription
    });

    // Clear form inputs
    eventNameInput.value = '';
    eventDateTimeInput.value = '';
    eventLocationInput.value = '';
    eventDescriptionInput.value = '';

  
    alert('Thank you for using the eventcalendar');
});


    // Display upcoming events from Firebase Realtime Database
    const eventsRef = ref(database, 'events');
    onValue(eventsRef, (snapshot) => {
        eventList.innerHTML = ''; // Clear existing event list

        if (snapshot.exists()) {
            const events = snapshot.val();

            for (const eventId in events) {
                const event = events[eventId];
                const eventDateTime = new Date(event.dateTime);
                const eventListItem = document.createElement('div');
                eventListItem.className = 'event-item';
                eventListItem.innerHTML = `
                    <h3>${event.name}</h3>
                    <p><strong>Date and Time:</strong> ${eventDateTime.toLocaleString()}</p>
                    <p><strong>Location:</strong> ${event.location}</p>
                    <p><strong>Description:</strong> ${event.description}</p>
                    <button class="update-button btn btn-primary" style="background-color: green;" data-event-id="${eventId}">Update</button>
                    <button class="delete-button btn btn-danger" style="background-color: red;" data-event-id="${eventId}">Delete</button>

                `;

                eventList.appendChild(eventListItem);
            }

            // Add event listeners to update and delete buttons
            const updateButtons = document.querySelectorAll('.btn.btn-primary');
const deleteButtons = document.querySelectorAll('.btn.btn-danger');

            updateButtons.forEach((button) => {
                button.addEventListener('click', (e) => {
                    const eventId = e.target.getAttribute('data-event-id');
                    const eventRef = ref(database, `events/${eventId}`);

                    // Fetch the event data and populate the form fields for editing
                    get(eventRef).then((snapshot) => {
                        if (snapshot.exists()) {
                            const eventData = snapshot.val();
                            eventNameInput.value = eventData.name;
                            eventDateTimeInput.value = eventData.dateTime;
                            eventLocationInput.value = eventData.location;
                            eventDescriptionInput.value = eventData.description;

                            // Add an event listener to update the event on form submission
                            eventForm.onsubmit = (e) => {
                                e.preventDefault();

                                // Get updated form values
                                const updatedEventName = eventNameInput.value;
                                const updatedEventDateTime = eventDateTimeInput.value;
                                const updatedEventLocation = eventLocationInput.value;
                                const updatedEventDescription = eventDescriptionInput.value;

                                // Update the event data in the database
                                update(eventRef, {
                                    name: updatedEventName,
                                    dateTime: updatedEventDateTime,
                                    location: updatedEventLocation,
                                    description: updatedEventDescription
                                });

                                // Clear form inputs and remove the submit event listener
                               
                            };
                        }
                    });
                });
            });

            deleteButtons.forEach((button) => {
                button.addEventListener('click', (e) => {
                    const eventId = e.target.getAttribute('data-event-id');
                    const eventRef = ref(database, `events/${eventId}`);

                    // Confirm with the user before deleting
                    if (confirm('Are you sure you want to delete this event?')) {
                        // Delete the event from the database
                        remove(eventRef);
                    }
                });
            });
        }
    });
</script>

</body>
</html>
